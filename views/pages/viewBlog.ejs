<!DOCTYPE html>
<html lang="en">
<%- include("../compo/head") -%>
<body>

    <!-- [ Navigation Menu ] Start -->
    <%- include("../compo/sidebar") -%>
    <!-- [ Navigation Menu ] End -->

    <!-- [ Header ] Start -->
    <%- include("../compo/header") -%>
    <!-- [ Header ] End -->

    <div class="pcoded-main-container">
        <div class="pcoded-wrapper">
            <div class="pcoded-content">
                <div class="pcoded-inner-content">
                    <div class="container mt-4">
                        <h1 class="text-center mb-4">View Blog</h1>
                        <div class="row">
                            <% const sortedBlogs = AdminBlog.sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt)) %>

                            <% sortedBlogs.forEach(blog => { %>
                                <div class="col-md-6 mb-4">
                                    <div class="card shadow-sm border-2 border-primary">
                                        <div class="card-body">
                                            <div class="blog-profile-img-dis d-flex align-items-center justify-content-between">
                                                <div class="profile-picture-container d-flex align-items-center justify-content-center" style="position: relative; display: inline-block;">
                                                    <img src="<%= blog.admin && blog.admin.path ? blog.admin.path : 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTF5-3YjBcXTqKUlOAeUUtuOLKgQSma2wGG1g&s' %>"  class="profile-picture"  alt="Profile Picture"  style="width: 70px; height: 70px; border-radius: 50%; object-fit: cover;">
													<div class="dis">
														<h4 class="card-title text-primary ps-2 m-0 text-black"><%= blog.admin.username %></h4>
																<p class="m-0 ps-2"><%= new Date(blog.createdAt).toLocaleString('en-US',{
																	weekday: 'long', 
																	year: 'numeric', 
																	month: 'long', 
																	day: 'numeric', 
																	hour: 'numeric', 
																	minute: 'numeric', 
																	second: 'numeric', 
																	hour12: true, 
																	<!-- timeZone: 'UTC' -->
																}) %></p>
													</div>
                                                </div>
												<span class="card-title text-primary ps-2 time-ago" data-time="<%= blog.createdAt %>"><%= new Date(blog.createdAt).toLocaleString('en-US') %></span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            <% }); %>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Required JS -->
    <%- include("../compo/footer") -%>

	<script>
        function timeAgo(date) {
            const now = new Date();
            const seconds = Math.floor((now - new Date(date)) / 1000);
            if (seconds < 60) return `${seconds} sec ago`;
            const minutes = Math.floor(seconds / 60);
            if (minutes < 60) return `${minutes} min ago`;
            const hours = Math.floor(minutes / 60);
            if (hours < 24) return `${hours} hours ago`;
            const days = Math.floor(hours / 24);
            return `${days} days ago`;
        }
        
        document.addEventListener("DOMContentLoaded", function () {
            document.querySelectorAll(".time-ago").forEach(function (element) {
                const time = element.getAttribute("data-time");
                element.innerText = timeAgo(time);
            });
        });
    </script>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</body>
</html>
